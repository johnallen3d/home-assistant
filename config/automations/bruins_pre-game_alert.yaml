id: '1763742898599'
alias: Bruins Pre-Game Alert
description: Notify me when the Bruins are about to play (pre-game).
triggers:
  - entity_id: sensor.boston_bruins
    to: PRE
    trigger: state
conditions:
  - condition: template
    alias: Game starts within 60 minutes
    value_template: >-
      {% set game_time = state_attr('sensor.boston_bruins', 'date') | as_datetime %}
      {% set diff_minutes = ((game_time - now()).total_seconds() / 60) %}
      {{ 0 <= diff_minutes <= 60 }}
actions:
  - data:
      title: "Bruins Game Incoming ðŸ¥…"
      message: >-
        Bruins about to start! Opponent: {{ state_attr('sensor.boston_bruins', 'opponent_name') }} Starts: {{ (state_attr('sensor.boston_bruins', 'date') | as_datetime).strftime('%-I:%M %p') }} ({{ state_attr('sensor.boston_bruins', 'kickoff_in') }})
      data:
        push:
          sound: default
    action: notify.mobile_app_john_allens_iphone
mode: single
